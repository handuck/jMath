this.j$=this.jStat=function(Math,undefined){var slice=Array.prototype.slice,toString=Object.prototype.toString,calcRdx=function(n,m){var val=n>m?n:m;return Math.pow(10,17-~~(Math.log(val>0?val:-val)*Math.LOG10E))},isArray=Array.isArray||function(arg){return toString.call(arg)==="[object Array]"},isFunction=function(arg){return toString.call(arg)==="[object Function]"},isNumber=function(arg){return toString.call(arg)==="[object Number]"&&!isNaN(arg)},toVector=function(arr){return[].concat.apply([],arr)};function jStat(){return new jStat.fn.init(arguments)}jStat.fn=jStat.prototype={constructor:jStat,init:function(args){var i=0;if(isArray(args[0])){if(isArray(args[0][0])){if(isFunction(args[1])){args[0]=jStat.map(args[0],args[1])}for(;i<args[0].length;i++){this[i]=args[0][i]}this.length=args[0].length}else{this[0]=isFunction(args[1])?jStat.map(args[0],args[1]):args[0];this.length=1}}else if(isNumber(args[0])){this[0]=jStat.seq.apply(null,args);this.length=1}else if(args[0]instanceof jStat){return jStat(args[0].toArray())}else{this[0]=[];this.length=1}return this},length:0,toArray:function(){return this.length>1?slice.call(this):slice.call(this)[0]},push:[].push,sort:[].sort,splice:[].splice,slice:[].slice};jStat.fn.init.prototype=jStat.fn;jStat.utils={calcRdx:calcRdx,isArray:isArray,isFunction:isFunction,isNumber:isNumber,toVector:toVector};jStat.extend=function(obj){var args=slice.call(arguments),i=1,j;if(args.length===1){for(j in obj){jStat[j]=obj[j]}return this}for(;i<args.length;i++){for(j in args[i])obj[j]=args[i][j]}return obj};jStat.extend({rows:function(arr){return arr.length||1},cols:function(arr){return arr[0].length||1},dimensions:function(arr){return{rows:jStat.rows(arr),cols:jStat.cols(arr)}},row:function(arr,index){return arr[index]},col:function(arr,index){var column=new Array(arr.length),i=0;for(;i<arr.length;i++){column[i]=[arr[i][index]]}return column},diag:function(arr){var row=0,nrow=jStat.rows(arr),res=new Array(nrow);for(;row<nrow;row++){res[row]=[arr[row][row]]}return res},antidiag:function(arr){var nrow=jStat.rows(arr)-1,res=new Array(nrow),i=0;for(;nrow>=0;nrow--,i++){res[i]=[arr[i][nrow]]}return res},transpose:function(arr){var obj=[],i=0,rows,cols,j;if(!isArray(arr[0]))arr=[arr];rows=arr.length;cols=arr[0].length;for(;i<cols;i++){obj.push(new Array(rows));for(j=0;j<rows;j++){obj[i][j]=arr[j][i]}}return obj.length===1?obj[0]:obj},map:function(arr,func,toAlter){var row=0,nrow,ncol,res,col;if(!isArray(arr[0]))arr=[arr];nrow=arr.length;ncol=arr[0].length;res=toAlter?arr:new Array(nrow);for(;row<nrow;row++){if(!res[row])res[row]=new Array(ncol);for(col=0;col<ncol;col++)res[row][col]=func(arr[row][col],row,col)}return res.length===1?res[0]:res},alter:function(arr,func){return jStat.map(arr,func,true)},create:function(rows,cols,func){var res=new Array(rows),i,j;if(isFunction(cols)){func=cols;cols=rows}for(i=0;i<rows;i++){res[i]=new Array(cols);for(j=0;j<cols;j++){res[i][j]=func(i,j)}}return res},zeros:function(rows,cols){if(!isNumber(cols))cols=rows;return jStat.create(rows,cols,function(){return 0})},ones:function(rows,cols){if(!isNumber(cols))cols=rows;return jStat.create(rows,cols,function(){return 1})},rand:function(rows,cols){if(!isNumber(cols))cols=rows;return jStat.create(rows,cols,function(){return Math.random()})},identity:function(rows,cols){if(!isNumber(cols))cols=rows;return jStat.create(rows,cols,function(i,j){return i===j?1:0})},symmetric:function(arr){var issymmetric=true,row=0,size=arr.length,col;if(arr.length!==arr[0].length)return false;for(;row<size;row++){for(col=0;col<size;col++){if(arr[col][row]!==arr[row][col])return false}}return true},clear:function(arr){return jStat.alter(arr,function(){return 0})},seq:function(min,max,length,func){if(!isFunction(func))func=false;var arr=[],hival=calcRdx(min,max),step=(max*hival-min*hival)/((length-1)*hival),current=min,cnt=0;for(;current<=max;cnt++,current=(min*hival+step*hival*cnt)/hival)arr.push(func?func(current,cnt):current);return arr}});(function(funcs){for(var i=0;i<funcs.length;i++)(function(passfunc){jStat.fn[passfunc]=function(func){var tmpthis=this,results;if(func){setTimeout(function(){func.call(tmpthis,jStat.fn[passfunc].call(tmpthis))},15);return this}results=jStat[passfunc](this);return isArray(results)?jStat(results):results}})(funcs[i])})("transpose clear symmetric rows cols dimensions diag antidiag".split(" "));(function(funcs){for(var i=0;i<funcs.length;i++)(function(passfunc){jStat.fn[passfunc]=function(index,func){var tmpthis=this;if(func){setTimeout(function(){func.call(tmpthis,jStat.fn[passfunc].call(tmpthis,index))},15);return this}return jStat(jStat[passfunc](this,index))}})(funcs[i])})("row col".split(" "));(function(funcs){for(var i=0;i<funcs.length;i++)(function(passfunc){jStat.fn[passfunc]=function(){return jStat(jStat[passfunc].apply(null,arguments))}})(funcs[i])})("create zeros ones rand identity".split(" "));jStat.extend(jStat.fn,{map:function(func,toAlter){return jStat(jStat.map(this,func,toAlter))},alter:function(func){jStat.alter(this,func);return this}});return jStat}(Math);(function(jStat,Math){var isFunction=jStat.utils.isFunction,ascNum=function(a,b){return a-b};jStat.extend({sum:function(arr){var sum=0,i=arr.length,tmp;while(--i>=0){sum+=arr[i]}return sum},sumsqrd:function(arr){var sum=0,i=arr.length;while(--i>=0)sum+=arr[i]*arr[i];return sum},sumsqerr:function(arr){var mean=jStat.mean(arr),sum=0,i=arr.length,tmp;while(--i>=0){tmp=arr[i]-mean;sum+=tmp*tmp}return sum},product:function(arr){var prod=1,i=arr.length;while(--i>=0)prod*=arr[i];return prod},min:function(arr){var low=arr[0],i=0;while(++i<arr.length)if(arr[i]<low)low=arr[i];return low},max:function(arr){var high=arr[0],i=0;while(++i<arr.length)if(arr[i]>high)high=arr[i];return high},mean:function(arr){return jStat.sum(arr)/arr.length},meansqerr:function(arr){return jStat.sumsqerr(arr)/arr.length},geomean:function(arr){return Math.pow(jStat.product(arr),1/arr.length)},median:function(arr){var arrlen=arr.length,_arr=arr.slice().sort(ascNum);return!(arrlen&1)?(_arr[arrlen/2-1]+_arr[arrlen/2])/2:_arr[arrlen/2|0]},cumsum:function(arr){var len=arr.length,sums=new Array(len),i=1;sums[0]=arr[0];for(;i<len;i++){sums[i]=sums[i-1]+arr[i]}return sums},diff:function(arr){var diffs=[],arrLen=arr.length,i=1;for(i=1;i<arrLen;i++){diffs.push(arr[i]-arr[i-1])}return diffs},mode:function(arr){var arrLen=arr.length,_arr=arr.slice().sort(ascNum),count=1,maxCount=0,numMaxCount=0,i=0,mode_arr=[];for(;i<arrLen;i++){if(_arr[i]===_arr[i+1]){count++}else{if(count>maxCount){mode_arr=[_arr[i]];maxCount=count;numMaxCount=0}else if(count===maxCount){mode_arr.push(_arr[i]);numMaxCount++}count=1}}return numMaxCount===0?mode_arr[0]:mode_arr},range:function(arr){return jStat.max(arr)-jStat.min(arr)},variance:function(arr,flag){return jStat.sumsqerr(arr)/(arr.length-(flag?1:0))},stdev:function(arr,flag){return Math.sqrt(jStat.variance(arr,flag))},meandev:function(arr){var devSum=0,mean=jStat.mean(arr),i=arr.length-1;for(;i>=0;i--){devSum+=Math.abs(arr[i]-mean)}return devSum/arr.length},meddev:function(arr){var devSum=0,median=jStat.median(arr),i=arr.length-1;for(;i>=0;i--){devSum+=Math.abs(arr[i]-median)}return devSum/arr.length},coeffvar:function(arr){return jStat.stdev(arr)/jStat.mean(arr)},quartiles:function(arr){var arrlen=arr.length,_arr=arr.slice().sort(ascNum);return[_arr[Math.round(arrlen/4)-1],_arr[Math.round(arrlen/2)-1],_arr[Math.round(arrlen*3/4)-1]]},covariance:function(arr1,arr2){var u=jStat.mean(arr1),v=jStat.mean(arr2),arr1Len=arr1.length,sq_dev=new Array(arr1Len),i=0;for(;i<arr1Len;i++){sq_dev[i]=(arr1[i]-u)*(arr2[i]-v)}return jStat.sum(sq_dev)/(arr1Len-1)},corrcoeff:function(arr1,arr2){return jStat.covariance(arr1,arr2)/jStat.stdev(arr1,1)/jStat.stdev(arr2,1)}});(function(funcs){for(var i=0;i<funcs.length;i++)(function(passfunc){jStat.fn[passfunc]=function(fullbool,func){var arr=[],i=0,tmpthis=this;if(isFunction(fullbool)){func=fullbool;fullbool=false}if(func){setTimeout(function(){func.call(tmpthis,jStat.fn[passfunc].call(tmpthis,fullbool))},15);return this}if(this.length>1){tmpthis=fullbool===true?this:this.transpose();for(;i<tmpthis.length;i++)arr[i]=jStat[passfunc](tmpthis[i]);return fullbool===true?jStat[passfunc](jStat.utils.toVector(arr)):arr}return jStat[passfunc](this[0],fullbool)}})(funcs[i])})("sum sumsqrd sumsqerr product min max mean meansqerr geomean median diff mode range variance stdev meandev meddev coeffvar quartiles".split(" "));jStat.fn.cumsum=function(fullbool,func){var arr=[],i=0,tmpthis=this;if(isFunction(fullbool)){func=fullbool;fullbool=false}if(func){setTimeout(function(){func.call(tmpthis,jStat.fn.cumsum.call(tmpthis,fullbool))},15);return this}if(this.length>1){tmpthis=fullbool===true?this:this.transpose();for(;i<tmpthis.length;i++)arr[i]=jStat.cumsum(tmpthis[i]);return arr}return jStat.cumsum(this[0],fullbool)}})(this.jStat,Math);(function(jStat,Math){jStat.extend({gammaln:function(x){var j=0,cof=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],ser=1.000000000190015,xx,y,tmp;tmp=(y=xx=x)+5.5;tmp-=(xx+.5)*Math.log(tmp);for(;j<6;j++)ser+=cof[j]/++y;return Math.log(2.5066282746310007*ser/xx)-tmp},gammafn:function(x){var p=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],q=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535],fact=false,n=0,xden=0,xnum=0,y=x,i,z,yi,res,sum,ysq;if(y<=0){res=y%1+3.6e-16;if(res){fact=(!(y&1)?1:-1)*Math.PI/Math.sin(Math.PI*res);y=1-y}else{return Infinity}}yi=y;if(y<1){z=y++}else{z=(y-=n=(y|0)-1)-1}for(i=0;i<8;++i){xnum=(xnum+p[i])*z;xden=xden*z+q[i]}res=xnum/xden+1;if(yi<y){res/=yi}else if(yi>y){for(i=0;i<n;++i){res*=y;y++}}if(fact){res=fact/res}return res},gammap:function(a,x){var aln=jStat.gammaln(a),ap=a,sum=1/a,del=sum,b=x+1-a,c=1/1e-30,d=1/b,h=d,i=1,ITMAX=-~(Math.log(a>=1?a:1/a)*8.5+a*.4+17),an,endval;if(x<0||a<=0){return NaN}else if(x<a+1){for(;i<=ITMAX;i++){sum+=del*=x/++ap}return sum*Math.exp(-x+a*Math.log(x)-aln)}for(;i<=ITMAX;i++){an=-i*(i-a);b+=2;d=an*d+b;c=b+an/c;d=1/d;h*=d*c}return 1-h*Math.exp(-x+a*Math.log(x)-aln)},factorialln:function(n){return n<0?NaN:jStat.gammaln(n+1)},factorial:function(n){return n<0?NaN:jStat.gammafn(n+1)},combination:function(n,m){return n>170||m>170?Math.exp(jStat.combinationln(n,m)):jStat.factorial(n)/jStat.factorial(m)/jStat.factorial(n-m)},combinationln:function(n,m){return jStat.factorialln(n)-jStat.factorialln(m)-jStat.factorialln(n-m)},permutation:function(n,m){return jStat.factorial(n)/jStat.factorial(n-m)},betafn:function(x,y){if(x<=0||y<=0)return undefined;return x+y>170?Math.exp(jStat.betaln(x,y)):jStat.gammafn(x)*jStat.gammafn(y)/jStat.gammafn(x+y)},betaln:function(x,y){return jStat.gammaln(x)+jStat.gammaln(y)-jStat.gammaln(x+y)},betacf:function(x,a,b){var fpmin=1e-30,m=1,m2,aa,c,d,del,h,qab,qam,qap;qab=a+b;qap=a+1;qam=a-1;c=1;d=1-qab*x/qap;if(Math.abs(d)<fpmin)d=fpmin;d=1/d;h=d;for(;m<=100;m++){m2=2*m;aa=m*(b-m)*x/((qam+m2)*(a+m2));d=1+aa*d;if(Math.abs(d)<fpmin)d=fpmin;c=1+aa/c;if(Math.abs(c)<fpmin)c=fpmin;d=1/d;h*=d*c;aa=-(a+m)*(qab+m)*x/((a+m2)*(qap+m2));d=1+aa*d;if(Math.abs(d)<fpmin)d=fpmin;c=1+aa/c;if(Math.abs(c)<fpmin)c=fpmin;d=1/d;del=d*c;h*=del;if(Math.abs(del-1)<3e-7)break}return h},gammapinv:function(p,a){var j=0,a1=a-1,EPS=1e-8,gln=jStat.gammaln(a),x,err,t,u,pp,lna1,afac;if(p>=1)return Math.max(100,a+100*Math.sqrt(a));if(p<=0)return 0;if(a>1){lna1=Math.log(a1);afac=Math.exp(a1*(lna1-1)-gln);pp=p<.5?p:1-p;t=Math.sqrt(-2*Math.log(pp));x=(2.30753+t*.27061)/(1+t*(.99229+t*.04481))-t;if(p<.5)x=-x;x=Math.max(.001,a*Math.pow(1-1/(9*a)-x/(3*Math.sqrt(a)),3))}else{t=1-a*(.253+a*.12);if(p<t)x=Math.pow(p/t,1/a);else x=1-Math.log(1-(p-t)/(1-t))}for(;j<12;j++){if(x<=0)return 0;err=jStat.gammap(a,x)-p;if(a>1)t=afac*Math.exp(-(x-a1)+a1*(Math.log(x)-lna1));else t=Math.exp(-x+a1*Math.log(x)-gln);u=err/t;x-=t=u/(1-.5*Math.min(1,u*((a-1)/x-1)));if(x<=0)x=.5*(x+t);if(Math.abs(t)<EPS*x)break}return x},erf:function(x){var cof=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,1.5626441722e-8,-8.5238095915e-8,6.529054439e-9,5.059343495e-9,-9.91364156e-10,-2.27365122e-10,9.6467911e-11,2.394038e-12,-6.886027e-12,8.94487e-13,3.13092e-13,-1.12708e-13,3.81e-16,7.106e-15,-1.523e-15,-9.4e-17,1.21e-16,-2.8e-17],j=cof.length-1,isneg=false,d=0,dd=0,t,ty,tmp,res;if(x<0){x=-x;isneg=true}t=2/(2+x);ty=4*t-2;for(;j>0;j--){tmp=d;d=ty*d-dd+cof[j];dd=tmp}res=t*Math.exp(-x*x+.5*(cof[0]+ty*d)-dd);return isneg?res-1:1-res},erfc:function(x){return 1-jStat.erf(x)},erfcinv:function(p){var j=0,x,err,t,pp;if(p>=2)return-100;if(p<=0)return 100;pp=p<1?p:2-p;t=Math.sqrt(-2*Math.log(pp/2));x=-.70711*((2.30753+t*.27061)/(1+t*(.99229+t*.04481))-t);for(;j<2;j++){err=jStat.erfc(x)-pp;x+=err/(1.1283791670955126*Math.exp(-x*x)-x*err)}return p<1?x:-x},ibetainv:function(p,a,b){var EPS=1e-8,a1=a-1,b1=b-1,j=0,lna,lnb,pp,t,u,err,x,al,h,w,afac;if(p<=0)return 0;if(p>=1)return 1;if(a>=1&&b>=1){pp=p<.5?p:1-p;t=Math.sqrt(-2*Math.log(pp));x=(2.30753+t*.27061)/(1+t*(.99229+t*.04481))-t;if(p<.5)x=-x;al=(x*x-3)/6;h=2/(1/(2*a-1)+1/(2*b-1));w=x*Math.sqrt(al+h)/h-(1/(2*b-1)-1/(2*a-1))*(al+5/6-2/(3*h));x=a/(a+b*Math.exp(2*w))}else{lna=Math.log(a/(a+b));lnb=Math.log(b/(a+b));t=Math.exp(a*lna)/a;u=Math.exp(b*lnb)/b;w=t+u;if(p<t/w)x=Math.pow(a*w*p,1/a);else x=1-Math.pow(b*w*(1-p),1/b)}afac=-jStat.gammaln(a)-jStat.gammaln(b)+jStat.gammaln(a+b);for(;j<10;j++){if(x===0||x===1)return x;err=jStat.ibeta(x,a,b)-p;t=Math.exp(a1*Math.log(x)+b1*Math.log(1-x)+afac);u=err/t;x-=t=u/(1-.5*Math.min(1,u*(a1/x-b1/(1-x))));if(x<=0)x=.5*(x+t);if(x>=1)x=.5*(x+t+1);if(Math.abs(t)<EPS*x&&j>0)break}return x},ibeta:function(x,a,b){var bt=x===0||x===1?0:Math.exp(jStat.gammaln(a+b)-jStat.gammaln(a)-jStat.gammaln(b)+a*Math.log(x)+b*Math.log(1-x));if(x<0||x>1)return false;if(x<(a+1)/(a+b+2))return bt*jStat.betacf(x,a,b)/a;return 1-bt*jStat.betacf(1-x,b,a)/b},randn:function(n,m){var u,v,x,y,q,mat;if(!m)m=n;if(n){return jStat.create(n,m,function(){return jStat.randn()})}do{u=Math.random();v=1.7156*(Math.random()-.5);x=u-.449871;y=Math.abs(v)+.386595;q=x*x+y*(.196*y-.25472*x)}while(q>.27597&&(q>.27846||v*v>-4*Math.log(u)*u*u));return v/u},randg:function(shape,n,m){var oalph=shape,a1,a2,u,v,x,mat;if(!m)m=n;if(!shape)shape=1;if(n){mat=jStat.zeros(n,m);mat.alter(function(){return jStat.randg(shape)});return mat}if(shape<1)shape+=1;a1=shape-1/3;a2=1/Math.sqrt(9*a1);do{do{x=jStat.randn();v=1+a2*x}while(v<=0);v=v*v*v;u=Math.random()}while(u>1-.331*Math.pow(x,4)&&Math.log(u)>.5*x*x+a1*(1-v+Math.log(v)));if(shape==oalph)return a1*v;do{u=Math.random()}while(u===0);return Math.pow(u,1/oalph)*a1*v}});(function(funcs){for(var i=0;i<funcs.length;i++)(function(passfunc){jStat.fn[passfunc]=function(){return jStat(jStat.map(this,function(value){return jStat[passfunc](value)}))}})(funcs[i])})("gammaln gammafn factorial factorialln".split(" "));(function(funcs){for(var i=0;i<funcs.length;i++)(function(passfunc){jStat.fn[passfunc]=function(){return jStat(jStat[passfunc].apply(null,arguments))}})(funcs[i])})("randn".split(" "))})(this.jStat,Math);(function(jStat,Math){(function(list){for(var i=0;i<list.length;i++)(function(func){jStat[func]=function(a,b,c){if(!(this instanceof arguments.callee))return new arguments.callee(a,b,c);this._a=a;this._b=b;this._c=c;return this};jStat.fn[func]=function(a,b,c){var newthis=jStat[func](a,b,c);newthis.data=this;return newthis};jStat[func].prototype.sample=function(arr){var a=this._a,b=this._b,c=this._c;if(arr)return jStat.alter(arr,function(){return jStat[func].sample(a,b,c)});else return jStat[func].sample(a,b,c)};(function(vals){for(var i=0;i<vals.length;i++)(function(fnfunc){jStat[func].prototype[fnfunc]=function(x){var a=this._a,b=this._b,c=this._c;if(!x)x=this.data;if(typeof x!=="number"){return jStat.fn.map.call(x,function(x){return jStat[func][fnfunc](x,a,b,c)})}return jStat[func][fnfunc](x,a,b,c)}})(vals[i])})("pdf cdf inv".split(" "));(function(vals){for(var i=0;i<vals.length;i++)(function(fnfunc){jStat[func].prototype[fnfunc]=function(){return jStat[func][fnfunc](this._a,this._b,this._c)}})(vals[i])})("mean median mode variance".split(" "))})(list[i])})(("beta centralF cauchy chisquare exponential gamma invgamma kumaraswamy lognormal normal "+"pareto studentt weibull uniform  binomial negbin hypgeom poisson triangular").split(" "));jStat.extend(jStat.beta,{pdf:function(x,alpha,beta){return x>1||x<0?0:Math.pow(x,alpha-1)*Math.pow(1-x,beta-1)/jStat.betafn(alpha,beta)},cdf:function(x,alpha,beta){return x>1||x<0?(x>1)*1:jStat.ibeta(x,alpha,beta)},inv:function(x,alpha,beta){return jStat.ibetainv(x,alpha,beta)},mean:function(alpha,beta){return alpha/(alpha+beta)},median:function(alpha,beta){},mode:function(alpha,beta){return alpha*beta/(Math.pow(alpha+beta,2)*(alpha+beta+1))},sample:function(alpha,beta){var u=jStat.randg(alpha);return u/(u+jStat.randg(beta))},variance:function(alpha,beta){return alpha*beta/(Math.pow(alpha+beta,2)*(alpha+beta+1))}});jStat.extend(jStat.centralF,{pdf:function(x,df1,df2){return x>=0?Math.sqrt(Math.pow(df1*x,df1)*Math.pow(df2,df2)/Math.pow(df1*x+df2,df1+df2))/(x*jStat.betafn(df1/2,df2/2)):undefined},cdf:function(x,df1,df2){return jStat.ibeta(df1*x/(df1*x+df2),df1/2,df2/2)},inv:function(x,df1,df2){return df2/(df1*(1/jStat.ibetainv(x,df1/2,df2/2)-1))},mean:function(df1,df2){return df2>2?df2/(df2-2):undefined},mode:function(df1,df2){return df1>2?df2*(df1-2)/(df1*(df2+2)):undefined},sample:function(df1,df2){var x1=jStat.randg(df1/2)*2;var x2=jStat.randg(df2/2)*2;return x1/df1/(x2/df2)},variance:function(df1,df2){return df2>4?2*df2*df2*(df1+df2-2)/(df1*(df2-2)*(df2-2)*(df2-4)):undefined}});jStat.extend(jStat.cauchy,{pdf:function(x,local,scale){return scale/(Math.pow(x-local,2)+Math.pow(scale,2))/Math.PI},cdf:function(x,local,scale){return Math.atan((x-local)/scale)/Math.PI+.5},inv:function(p,local,scale){return local+scale*Math.tan(Math.PI*(p-.5))},median:function(local,scale){return local},mode:function(local,scale){return local},sample:function(local,scale){return jStat.randn()*Math.sqrt(1/(2*jStat.randg(.5)))*scale+local}});jStat.extend(jStat.chisquare,{pdf:function(x,dof){return Math.exp((dof/2-1)*Math.log(x)-x/2-dof/2*Math.log(2)-jStat.gammaln(dof/2))},cdf:function(x,dof){return jStat.gammap(dof/2,x/2)},inv:function(p,dof){return 2*jStat.gammapinv(p,.5*dof)},mean:function(dof){return dof},median:function(dof){return dof*Math.pow(1-2/(9*dof),3)},mode:function(dof){return dof-2>0?dof-2:0},sample:function(dof){return jStat.randg(dof/2)*2},variance:function(dof){return 2*dof}});jStat.extend(jStat.exponential,{pdf:function(x,rate){return x<0?0:rate*Math.exp(-rate*x)},cdf:function(x,rate){return x<0?0:1-Math.exp(-rate*x)},inv:function(p,rate){return-Math.log(1-p)/rate},mean:function(rate){return 1/rate},median:function(rate){return 1/rate*Math.log(2)},mode:function(rate){return 0},sample:function(rate){return-1/rate*Math.log(Math.random())},variance:function(rate){return Math.pow(rate,-2)}});jStat.extend(jStat.gamma,{pdf:function(x,shape,scale){return Math.exp((shape-1)*Math.log(x)-x/scale-jStat.gammaln(shape)-shape*Math.log(scale))},cdf:function(x,shape,scale){return jStat.gammap(shape,x/scale)},inv:function(p,shape,scale){return jStat.gammapinv(p,shape)*scale},mean:function(shape,scale){return shape*scale},mode:function(shape,scale){if(shape>1)return(shape-1)*scale;return undefined},sample:function(shape,scale){return jStat.randg(shape)*scale},variance:function(shape,scale){return shape*scale*scale}});jStat.extend(jStat.invgamma,{pdf:function(x,shape,scale){return Math.exp(-(shape+1)*Math.log(x)-scale/x-jStat.gammaln(shape)+shape*Math.log(scale))},cdf:function(x,shape,scale){return 1-jStat.gammap(shape,scale/x)},inv:function(p,shape,scale){return scale/jStat.gammapinv(1-p,shape)},mean:function(shape,scale){return shape>1?scale/(shape-1):undefined},mode:function(shape,scale){return scale/(shape+1)},sample:function(shape,scale){return scale/jStat.randg(shape)},variance:function(shape,scale){return shape>2?scale*scale/((shape-1)*(shape-1)*(shape-2)):undefined}});jStat.extend(jStat.kumaraswamy,{pdf:function(x,alpha,beta){return Math.exp(Math.log(alpha)+Math.log(beta)+(alpha-1)*Math.log(x)+(beta-1)*Math.log(1-Math.pow(x,alpha)))},cdf:function(x,alpha,beta){return 1-Math.pow(1-Math.pow(x,alpha),beta)},mean:function(alpha,beta){return beta*jStat.gammafn(1+1/alpha)*jStat.gammafn(beta)/jStat.gammafn(1+1/alpha+beta)},median:function(alpha,beta){return Math.pow(1-Math.pow(2,-1/beta),1/alpha)},mode:function(alpha,beta){return alpha>=1&&beta>=1&&(alpha!==1&&beta!==1)?Math.pow((alpha-1)/(alpha*beta-1),1/alpha):undefined},variance:function(alpha,beta){}});jStat.extend(jStat.lognormal,{pdf:function(x,mu,sigma){return Math.exp(-Math.log(x)-.5*Math.log(2*Math.PI)-Math.log(sigma)-Math.pow(Math.log(x)-mu,2)/(2*sigma*sigma))},cdf:function(x,mu,sigma){return.5+.5*jStat.erf((Math.log(x)-mu)/Math.sqrt(2*sigma*sigma))},inv:function(p,mu,sigma){return Math.exp(-1.4142135623730951*sigma*jStat.erfcinv(2*p)+mu)},mean:function(mu,sigma){return Math.exp(mu+sigma*sigma/2)},median:function(mu,sigma){return Math.exp(mu)},mode:function(mu,sigma){return Math.exp(mu-sigma*sigma)},sample:function(mu,sigma){return Math.exp(jStat.randn()*sigma+mu)},variance:function(mu,sigma){return(Math.exp(sigma*sigma)-1)*Math.exp(2*mu+sigma*sigma)}});jStat.extend(jStat.normal,{pdf:function(x,mean,std){return Math.exp(-.5*Math.log(2*Math.PI)-Math.log(std)-Math.pow(x-mean,2)/(2*std*std))},cdf:function(x,mean,std){return.5*(1+jStat.erf((x-mean)/Math.sqrt(2*std*std)))},inv:function(p,mean,std){return-1.4142135623730951*std*jStat.erfcinv(2*p)+mean},mean:function(mean,std){return mean},median:function(mean,std){return mean},mode:function(mean,std){return mean},sample:function(mean,std){return jStat.randn()*std+mean},variance:function(mean,std){return std*std}});jStat.extend(jStat.pareto,{pdf:function(x,scale,shape){return x>scale?shape*Math.pow(scale,shape)/Math.pow(x,shape+1):undefined},cdf:function(x,scale,shape){return 1-Math.pow(scale/x,shape)},mean:function(scale,shape){return shape>1?shape*Math.pow(scale,shape)/(shape-1):undefined},median:function(scale,shape){return scale*(shape*Math.SQRT2)},mode:function(scale,shape){return scale},variance:function(scale,shape){return shape>2?scale*scale*shape/(Math.pow(shape-1,2)*(shape-2)):undefined}});jStat.extend(jStat.studentt,{pdf:function(x,dof){return jStat.gammafn((dof+1)/2)/(Math.sqrt(dof*Math.PI)*jStat.gammafn(dof/2))*Math.pow(1+x*x/dof,-((dof+1)/2))},cdf:function(x,dof){var dof2=dof/2;return jStat.ibeta((x+Math.sqrt(x*x+dof))/(2*Math.sqrt(x*x+dof)),dof2,dof2)},inv:function(p,dof){var x=jStat.ibetainv(2*Math.min(p,1-p),.5*dof,.5);x=Math.sqrt(dof*(1-x)/x);return p>0?x:-x},mean:function(dof){return dof>1?0:undefined},median:function(dof){return 0},mode:function(dof){return 0},sample:function(dof){return jStat.randn()*Math.sqrt(dof/(2*jStat.randg(dof/2)))},variance:function(dof){return dof>2?dof/(dof-2):dof>1?Infinity:undefined}});jStat.extend(jStat.weibull,{pdf:function(x,scale,shape){return x<0?0:shape/scale*Math.pow(x/scale,shape-1)*Math.exp(-Math.pow(x/scale,shape))},cdf:function(x,scale,shape){return x<0?0:1-Math.exp(-Math.pow(x/scale,shape))},inv:function(p,scale,shape){return scale*Math.pow(-Math.log(1-p),1/shape)},mean:function(scale,shape){return scale*jStat.gammafn(1+1/shape)},median:function(scale,shape){return scale*Math.pow(Math.log(2),1/shape)},mode:function(scale,shape){return shape>1?scale*Math.pow((shape-1)/shape,1/shape):undefined},sample:function(scale,shape){return scale*Math.pow(-Math.log(Math.random()),1/shape)},variance:function(scale,shape){return scale*scale*jStat.gammafn(1+2/shape)-Math.pow(this.mean(scale,shape),2)}});jStat.extend(jStat.uniform,{pdf:function(x,a,b){return x<a||x>b?0:1/(b-a)},cdf:function(x,a,b){if(x<a){return 0}else if(x<b){return(x-a)/(b-a)}return 1},mean:function(a,b){return.5*(a+b)},median:function(a,b){return jStat.mean(a,b)},mode:function(a,b){},sample:function(a,b){return a/2+b/2+(b/2-a/2)*(2*Math.random()-1)},variance:function(a,b){return Math.pow(b-a,2)/12}});jStat.extend(jStat.binomial,{pdf:function(k,n,p){return p===0||p===1?n*p===k?1:0:jStat.combination(n,k)*Math.pow(p,k)*Math.pow(1-p,n-k)},cdf:function(x,n,p){var binomarr=[],k=0;if(x<0){return 0}if(x<n){for(;k<=x;k++){binomarr[k]=jStat.binomial.pdf(k,n,p)}return jStat.sum(binomarr)}return 1}});jStat.extend(jStat.negbin,{pdf:function(k,r,p){return k!==k|0?false:k<0?0:jStat.combination(k+r-1,k)*Math.pow(1-p,r)*Math.pow(p,k)},cdf:function(x,r,p){var sum=0,k=0;if(x<0)return 0;for(;k<=x;k++){sum+=jStat.negbin.pdf(k,r,p)}return sum}});jStat.extend(jStat.hypgeom,{pdf:function(k,N,m,n){return k!==k|0?false:k<0?0:jStat.combination(m,k)*jStat.combination(N-m,n-k)/jStat.combination(N,n)},cdf:function(x,N,m,n){var sum=0,k=0;if(x<0)return 0;for(;k<=x;k++){sum+=jStat.hypgeom.pdf(k,N,m,n)}return sum}});jStat.extend(jStat.poisson,{pdf:function(k,l){return Math.pow(l,k)*Math.exp(-l)/jStat.factorial(k)},cdf:function(x,l){var sumarr=[],k=0;if(x<0)return 0;for(;k<=x;k++){sumarr.push(jStat.poisson.pdf(k,l))}return jStat.sum(sumarr)},mean:function(l){return l},variance:function(l){return l},sample:function(l){var p=1,k=0,L=Math.exp(-l);do{k++;p*=Math.random()}while(p>L);return k-1}});jStat.extend(jStat.triangular,{pdf:function(x,a,b,c){return b<=a||c<a||c>b?undefined:x<a||x>b?0:x<=c?2*(x-a)/((b-a)*(c-a)):2*(b-x)/((b-a)*(b-c))},cdf:function(x,a,b,c){if(b<=a||c<a||c>b)return undefined;if(x<a){return 0}else{if(x<=c)return Math.pow(x-a,2)/((b-a)*(c-a));return 1-Math.pow(b-x,2)/((b-a)*(b-c))}return 1},mean:function(a,b,c){return(a+b+c)/3},median:function(a,b,c){if(c<=(a+b)/2){return b-Math.sqrt((b-a)*(b-c))/Math.sqrt(2)}else if(c>(a+b)/2){return a+Math.sqrt((b-a)*(c-a))/Math.sqrt(2)}},mode:function(a,b,c){return c},sample:function(a,b,c){var u=Math.random();return u<(c-a)/(b-a)?a+Math.sqrt(u*(b-a)*(c-a)):b-Math.sqrt((1-u)*(b-a)*(b-c))},variance:function(a,b,c){return(a*a+b*b+c*c-a*b-a*c-b*c)/18}})})(this.jStat,Math);(function(jStat,Math){var push=Array.prototype.push,isArray=jStat.utils.isArray;jStat.extend({add:function(arr,arg){if(isArray(arg)){if(!isArray(arg[0]))arg=[arg];return jStat.map(arr,function(value,row,col){return value+arg[row][col]})}return jStat.map(arr,function(value){return value+arg})},subtract:function(arr,arg){if(isArray(arg)){if(!isArray(arg[0]))arg=[arg];return jStat.map(arr,function(value,row,col){return value-arg[row][col]||0})}return jStat.map(arr,function(value){return value-arg})},divide:function(arr,arg){if(isArray(arg)){if(!isArray(arg[0]))arg=[arg];return jStat.multiply(arr,jStat.inv(arg))}return jStat.map(arr,function(value){return value/arg})},multiply:function(arr,arg){var row,col,nrescols,sum,nrow=arr.length,ncol=arr[0].length,res=jStat.zeros(nrow,nrescols=isArray(arg)?arg[0].length:ncol),rescols=0;if(isArray(arg)){for(;rescols<nrescols;rescols++){for(row=0;row<nrow;row++){sum=0;for(col=0;col<ncol;col++)sum+=arr[row][col]*arg[col][rescols];res[row][rescols]=sum}}return nrow===1&&rescols===1?res[0][0]:res}return jStat.map(arr,function(value){return value*arg})},dot:function(arr,arg){if(!isArray(arr[0]))arr=[arr];if(!isArray(arg[0]))arg=[arg];var left=arr[0].length===1&&arr.length!==1?jStat.transpose(arr):arr,right=arg[0].length===1&&arg.length!==1?jStat.transpose(arg):arg,res=[],row=0,nrow=left.length,ncol=left[0].length,sum,col;for(;row<nrow;row++){res[row]=[];sum=0;for(col=0;col<ncol;col++)sum+=left[row][col]*right[row][col];res[row]=sum}return res.length===1?res[0]:res},pow:function(arr,arg){return jStat.map(arr,function(value){return Math.pow(value,arg)})},abs:function(arr){return jStat.map(arr,function(value){return Math.abs(value)})},norm:function(arr,p){var nnorm=0,i=0;if(isNaN(p))p=2;if(isArray(arr[0]))arr=arr[0];for(;i<arr.length;i++){nnorm+=Math.pow(Math.abs(arr[i]),p)}return Math.pow(nnorm,1/p)},angle:function(arr,arg){return Math.acos(jStat.dot(arr,arg)/(jStat.norm(arr)*jStat.norm(arg)))},aug:function(a,b){var newarr=a.slice(),i=0;for(;i<newarr.length;i++){push.apply(newarr[i],b[i])}return newarr},inv:function(a){var rows=a.length,cols=a[0].length,b=jStat.identity(rows,cols),c=jStat.gauss_jordan(a,b),obj=[],i=0,j;for(;i<rows;i++){obj[i]=[];for(j=cols-1;j<c[0].length;j++)obj[i][j-cols]=c[i][j]}return obj},det:function(a){var alen=a.length,alend=alen*2,vals=new Array(alend),rowshift=alen-1,colshift=alend-1,mrow=rowshift-alen+1,mcol=colshift,i=0,result=0,j;if(alen===2){return a[0][0]*a[1][1]-a[0][1]*a[1][0]}for(;i<alend;i++){vals[i]=1}for(i=0;i<alen;i++){for(j=0;j<alen;j++){vals[mrow<0?mrow+alen:mrow]*=a[i][j];vals[mcol<alen?mcol+alen:mcol]*=a[i][j];mrow++;mcol--}mrow=--rowshift-alen+1;mcol=--colshift}for(i=0;i<alen;i++){result+=vals[i]}for(;i<alend;i++){result-=vals[i]}return result},gauss_elimination:function(a,b){var i=0,j=0,n=a.length,m=a[0].length,factor=1,sum=0,x=[],maug,pivot,temp,k;a=jStat.aug(a,b);maug=a[0].length;for(;i<n;i++){pivot=a[i][i];j=i;for(k=i+1;k<m;k++){if(pivot<Math.abs(a[k][i])){pivot=a[k][i];j=k}}if(j!=i){for(k=0;k<maug;k++){temp=a[i][k];a[i][k]=a[j][k];a[j][k]=temp}}for(j=i+1;j<n;j++){factor=a[j][i]/a[i][i];for(k=i;k<maug;k++){a[j][k]=a[j][k]-factor*a[i][k]}}}for(i=n-1;i>=0;i--){sum=0;for(j=i+1;j<=n-1;j++){sum=x[j]*a[i][j]}x[i]=(a[i][maug-1]-sum)/a[i][i]}return x},gauss_jordan:function(a,b){var m=jStat.aug(a,b),h=m.length,w=m[0].length;for(var y=0;y<h;y++){var maxrow=y;for(var y2=y+1;y2<h;y2++){if(Math.abs(m[y2][y])>Math.abs(m[maxrow][y]))maxrow=y2}var tmp=m[y];m[y]=m[maxrow];m[maxrow]=tmp;for(var y2=y+1;y2<h;y2++){c=m[y2][y]/m[y][y];for(var x=y;x<w;x++){m[y2][x]-=m[y][x]*c}}}for(var y=h-1;y>=0;y--){c=m[y][y];for(var y2=0;y2<y;y2++){for(var x=w-1;x>y-1;x--){m[y2][x]-=m[y][x]*m[y2][y]/c}}m[y][y]/=c;for(var x=h;x<w;x++){m[y][x]/=c}}return m},lu:function(a,b){},cholesky:function(a,b){},gauss_jacobi:function(a,b,x,r){var i=0,j=0,n=a.length,l=[],u=[],d=[],xv,c,h,xk;for(;i<n;i++){l[i]=[];u[i]=[];d[i]=[];for(j=0;j<n;j++){if(i>j){l[i][j]=a[i][j];u[i][j]=d[i][j]=0}else if(i<j){u[i][j]=a[i][j];l[i][j]=d[i][j]=0}else{d[i][j]=a[i][j];l[i][j]=u[i][j]=0}}}h=jStat.multiply(jStat.multiply(jStat.inv(d),jStat.add(l,u)),-1);c=jStat.multiply(jStat.inv(d),b);xv=x;xk=jStat.add(jStat.multiply(h,x),c);i=2;while(Math.abs(jStat.norm(jStat.subtract(xk,xv)))>r){xv=xk;xk=jStat.add(jStat.multiply(h,xv),c);i++}return xk},gauss_seidel:function(a,b,x,r){var i=0,n=a.length,l=[],u=[],d=[],j,xv,c,h,xk;for(;i<n;i++){l[i]=[];u[i]=[];d[i]=[];for(j=0;j<n;j++){if(i>j){l[i][j]=a[i][j];u[i][j]=d[i][j]=0}else if(i<j){u[i][j]=a[i][j];l[i][j]=d[i][j]=0}else{d[i][j]=a[i][j];l[i][j]=u[i][j]=0}}}h=jStat.multiply(jStat.multiply(jStat.inv(jStat.add(d,l)),u),-1);c=jStat.multiply(jStat.inv(jStat.add(d,l)),b);xv=x;xk=jStat.add(jStat.multiply(h,x),c);i=2;while(Math.abs(jStat.norm(jStat.subtract(xk,xv)))>r){xv=xk;xk=jStat.add(jStat.multiply(h,xv),c);i=i+1}return xk},SOR:function(a,b,x,r,w){var i=0,n=a.length,l=[],u=[],d=[],j,xv,c,h,xk;for(;i<n;i++){l[i]=[];u[i]=[];d[i]=[];for(j=0;j<n;j++){if(i>j){l[i][j]=a[i][j];u[i][j]=d[i][j]=0}else if(i<j){u[i][j]=a[i][j];l[i][j]=d[i][j]=0}else{d[i][j]=a[i][j];l[i][j]=u[i][j]=0}}}h=jStat.multiply(jStat.inv(jStat.add(d,jStat.multiply(l,w))),jStat.subtract(jStat.multiply(d,1-w),jStat.multiply(u,w)));c=jStat.multiply(jStat.multiply(jStat.inv(jStat.add(d,jStat.multiply(l,w))),b),w);xv=x;xk=jStat.add(jStat.multiply(h,x),c);i=2;while(Math.abs(jStat.norm(jStat.subtract(xk,xv)))>r){xv=xk;xk=jStat.add(jStat.multiply(h,xv),c);i++}return xk},householder:function(a){var m=a.length,n=a[0].length,i=0,w=[],p=[],alpha,r,k,j,factor;for(;i<m-1;i++){alpha=0;for(j=i+1;j<n;j++)alpha+=a[j][i]*a[j][i];factor=a[i+1][i]>0?-1:1;alpha=factor*Math.sqrt(alpha);r=Math.sqrt((alpha*alpha-a[i+1][i]*alpha)/2);
w=jStat.zeros(m,1);w[i+1][0]=(a[i+1][i]-alpha)/(2*r);for(k=i+2;k<m;k++)w[k][0]=a[k][i]/(2*r);p=jStat.subtract(jStat.identity(m,n),jStat.multiply(jStat.multiply(w,jStat.transpose(w)),2));a=jStat.multiply(p,jStat.multiply(a,p))}return a},QR:function(a,b){var m=a.length,n=a[0].length,i=0,w=[],p=[],x=[],j,alpha,r,k,factor,sum;for(;i<m-1;i++){alpha=0;for(j=i+1;j<n;j++)alpha+=a[j][i]*a[j][i];factor=a[i+1][i]>0?-1:1;alpha=factor*Math.sqrt(alpha);r=Math.sqrt((alpha*alpha-a[i+1][i]*alpha)/2);w=jStat.zeros(m,1);w[i+1][0]=(a[i+1][i]-alpha)/(2*r);for(k=i+2;k<m;k++)w[k][0]=a[k][i]/(2*r);p=jStat.subtract(jStat.identity(m,n),jStat.multiply(jStat.multiply(w,jStat.transpose(w)),2));a=jStat.multiply(p,a);b=jStat.multiply(p,b)}for(i=m-1;i>=0;i--){sum=0;for(j=i+1;j<=n-1;j++)sum=x[j]*a[i][j];x[i]=b[i][0]/a[i][i]}return x},jacobi:function(a){var condition=1,count=0,n=a.length,e=jStat.identity(n,n),ev=[],b,i,j,p,q,maxim,theta,s;while(condition===1){count++;maxim=a[0][1];p=0;q=1;for(i=0;i<n;i++){for(j=0;j<n;j++){if(i!=j){if(maxim<Math.abs(a[i][j])){maxim=Math.abs(a[i][j]);p=i;q=j}}}}if(a[p][p]===a[q][q])theta=a[p][q]>0?Math.PI/4:-Math.PI/4;else theta=Math.atan(2*a[p][q]/(a[p][p]-a[q][q]))/2;s=jStat.identity(n,n);s[p][p]=Math.cos(theta);s[p][q]=-Math.sin(theta);s[q][p]=Math.sin(theta);s[q][q]=Math.cos(theta);e=jStat.multiply(e,s);b=jStat.multiply(jStat.multiply(jStat.inv(s),a),s);a=b;condition=0;for(i=1;i<n;i++){for(j=1;j<n;j++){if(i!=j&&Math.abs(a[i][j])>.001){condition=1}}}}for(i=0;i<n;i++)ev.push(a[i][i]);return[e,ev]},rungekutta:function(f,h,p,t_j,u_j,order){var k1,k2,u_j1,k3,k4;if(order===2){while(t_j<=p){k1=h*f(t_j,u_j);k2=h*f(t_j+h,u_j+k1);u_j1=u_j+(k1+k2)/2;u_j=u_j1;t_j=t_j+h}}if(order===4){while(t_j<=p){k1=h*f(t_j,u_j);k2=h*f(t_j+h/2,u_j+k1/2);k3=h*f(t_j+h/2,u_j+k2/2);k4=h*f(t_j+h,u_j+k3);u_j1=u_j+(k1+2*k2+2*k3+k4)/6;u_j=u_j1;t_j=t_j+h}}return u_j},romberg:function(f,a,b,order){var i=0,h=(b-a)/2,x=[],h1=[],g=[],m,a1,j,k,I,d;while(i<order/2){I=f(a);for(j=a,k=0;j<=b;j=j+h,k++)x[k]=j;m=x.length;for(j=1;j<m-1;j++){I+=(j%2!==0?4:2)*f(x[j])}I=h/3*(I+f(b));g[i]=I;h/=2;i++}a1=g.length;m=1;while(a1!==1){for(j=0;j<a1-1;j++)h1[j]=(Math.pow(4,m)*g[j+1]-g[j])/(Math.pow(4,m)-1);a1=h1.length;g=h1;h1=[];m++}return g},richardson:function(X,f,x,h){function pos(X,x){var i=0,n=X.length,p;for(;i<n;i++)if(X[i]===x)p=i;return p}var n=X.length,h_min=Math.abs(x-X[pos(X,x)+1]),i=0,g=[],h1=[],y1,y2,m,a,j;while(h>=h_min){y1=pos(X,x+h);y2=pos(X,x);g[i]=(f[y1]-2*f[y2]+f[2*y2-y1])/(h*h);h/=2;i++}a=g.length;m=1;while(a!=1){for(j=0;j<a-1;j++)h1[j]=(Math.pow(4,m)*g[j+1]-g[j])/(Math.pow(4,m)-1);a=h1.length;g=h1;h1=[];m++}return g},simpson:function(f,a,b,n){var h=(b-a)/n,I=f(a),x=[],j=a,k=0,i=1,m;for(;j<=b;j=j+h,k++)x[k]=j;m=x.length;for(;i<m-1;i++){I+=(i%2!==0?4:2)*f(x[i])}return h/3*(I+f(b))},hermite:function(X,F,dF,value){var n=X.length,p=0,i=0,l=[],dl=[],A=[],B=[],j;for(;i<n;i++){l[i]=1;for(j=0;j<n;j++){if(i!=j)l[i]*=(value-X[j])/(X[i]-X[j])}dl[i]=0;for(j=0;j<n;j++){if(i!=j)dl[i]+=1/(X[i]-X[j])}A[i]=(1-2*(value-X[i])*dl[i])*(l[i]*l[i]);B[i]=(value-X[i])*(l[i]*l[i]);p+=A[i]*F[i]+B[i]*dF[i]}return p},lagrange:function(X,F,value){var p=0,i=0,j,l,n=X.length;for(;i<n;i++){l=F[i];for(j=0;j<n;j++){if(i!=j)l*=(value-X[j])/(X[i]-X[j])}p+=l}return p},cubic_spline:function(X,F,value){var n=X.length,i=0,j,A=[],B=[],alpha=[],c=[],h=[],b=[],d=[];for(;i<n-1;i++)h[i]=X[i+1]-X[i];alpha[0]=0;for(i=1;i<n-1;i++)alpha[i]=3/h[i]*(F[i+1]-F[i])-3/h[i-1]*(F[i]-F[i-1]);for(i=1;i<n-1;i++){A[i]=[];B[i]=[];A[i][i-1]=h[i-1];A[i][i]=2*(h[i-1]+h[i]);A[i][i+1]=h[i];B[i][0]=alpha[i]}c=jStat.multiply(jStat.inv(A),B);for(j=0;j<n-1;j++){b[j]=(F[j+1]-F[j])/h[j]-h[j]*(c[j+1][0]+2*c[j][0])/3;d[j]=(c[j+1][0]-c[j][0])/(3*h[j])}for(j=0;j<n;j++){if(X[j]>value)break}j-=1;return F[j]+(value-X[j])*b[j]+jStat.sq(value-X[j])*c[j]+(value-X[j])*jStat.sq(value-X[j])*d[j]},gauss_quadrature:function(){},PCA:function(X){var m=X.length,n=X[0].length,flag=false,i=0,j,temp1,u=[],D=[],result=[],temp2=[],Y=[],Bt=[],B=[],C=[],V=[],Vt=[];for(i=0;i<m;i++){u[i]=jStat.sum(X[i])/n}for(i=0;i<n;i++){B[i]=[];for(j=0;j<m;j++){B[i][j]=X[j][i]-u[j]}}B=jStat.transpose(B);for(i=0;i<m;i++){C[i]=[];for(j=0;j<m;j++){C[i][j]=jStat.dot([B[i]],[B[j]])/(n-1)}}result=jStat.jacobi(C);V=result[0];D=result[1];Vt=jStat.transpose(V);for(i=0;i<D.length;i++){for(j=i;j<D.length;j++){if(D[i]<D[j]){temp1=D[i];D[i]=D[j];D[j]=temp1;temp2=Vt[i];Vt[i]=Vt[j];Vt[j]=temp2}}}Bt=jStat.transpose(B);for(i=0;i<m;i++){Y[i]=[];for(j=0;j<Bt.length;j++){Y[i][j]=jStat.dot([Vt[i]],[Bt[j]])}}return[X,D,Vt,Y]}});(function(funcs){for(var i=0;i<funcs.length;i++)(function(passfunc){jStat.fn[passfunc]=function(arg,func){var tmpthis=this;if(func){setTimeout(function(){func.call(tmpthis,jStat.fn[passfunc].call(tmpthis,arg))},15);return this}return jStat(jStat[passfunc](this,arg))}})(funcs[i])})("add divide multiply subtract dot pow abs norm angle".split(" "))})(this.jStat,Math);(function(jStat,Math){var slice=[].slice,isNumber=jStat.utils.isNumber;jStat.extend({zscore:function(){var args=slice.call(arguments);if(isNumber(args[1])){return(args[0]-args[1])/args[2]}return(args[0]-jStat.mean(args[1]))/jStat.stdev(args[1],args[2])},ztest:function(){var args=slice.call(arguments);if(args.length===4){if(isNumber(args[1])){var z=jStat.zscore(args[0],args[1],args[2]);return args[3]===1?jStat.normal.cdf(-Math.abs(z),0,1):jStat.normal.cdf(-Math.abs(z),0,1)*2}var z=args[0];return args[2]===1?jStat.normal.cdf(-Math.abs(z),0,1):jStat.normal.cdf(-Math.abs(z),0,1)*2}var z=jStat.zscore(args[0],args[1],args[3]);return args[1]===1?jStat.normal.cdf(-Math.abs(z),0,1):jStat.normal.cdf(-Math.abs(z),0,1)*2}});jStat.extend(jStat.fn,{zscore:function(value,flag){return(value-this.mean())/this.stdev(flag)},ztest:function(value,sides,flag){var zscore=Math.abs(this.zscore(value,flag));return sides===1?jStat.normal.cdf(-zscore,0,1):jStat.normal.cdf(-zscore,0,1)*2}});jStat.extend({tscore:function(){var args=slice.call(arguments);return args.length===4?(args[0]-args[1])/(args[2]/Math.sqrt(args[3])):(args[0]-jStat.mean(args[1]))/(jStat.stdev(args[1],true)/Math.sqrt(args[1].length))},ttest:function(){var args=slice.call(arguments);var tscore;if(args.length===5){tscore=Math.abs(jStat.tscore(args[0],args[1],args[2],args[3]));return args[4]===1?jStat.studentt.cdf(-tscore,args[3]-1):jStat.studentt.cdf(-tscore,args[3]-1)*2}if(isNumber(args[1])){tscore=Math.abs(args[0]);return args[2]==1?jStat.studentt.cdf(-tscore,args[1]-1):jStat.studentt.cdf(-tscore,args[1]-1)*2}tscore=Math.abs(jStat.tscore(args[0],args[1]));return args[2]==1?jStat.studentt.cdf(-tscore,args[1].length-1):jStat.studentt.cdf(-tscore,args[1].length-1)*2}});jStat.extend(jStat.fn,{tscore:function(value){return(value-this.mean())/(this.stdev(true)/Math.sqrt(this.cols()))},ttest:function(value,sides){return sides===1?1-jStat.studentt.cdf(Math.abs(this.tscore(value)),this.cols()-1):jStat.studentt.cdf(-Math.abs(this.tscore(value)),this.cols()-1)*2}});jStat.extend({anovafscore:function(){var args=slice.call(arguments),expVar,sample,sampMean,sampSampMean,tmpargs,unexpVar,i,j;if(args.length===1){tmpargs=new Array(args[0].length);for(i=0;i<args[0].length;i++){tmpargs[i]=args[0][i]}args=tmpargs}if(args.length===2){return jStat.variance(args[0])/jStat.variance(args[1])}sample=new Array;for(i=0;i<args.length;i++){sample=sample.concat(args[i])}sampMean=jStat.mean(sample);expVar=0;for(i=0;i<args.length;i++){expVar=expVar+args[i].length*Math.pow(jStat.mean(args[i])-sampMean,2)}expVar/=args.length-1;unexpVar=0;for(i=0;i<args.length;i++){sampSampMean=jStat.mean(args[i]);for(j=0;j<args[i].length;j++){unexpVar+=Math.pow(args[i][j]-sampSampMean,2)}}unexpVar/=sample.length-args.length;return expVar/unexpVar},anovaftest:function(){var args=slice.call(arguments),df1,df2,n,i;if(isNumber(args[0])){return 1-jStat.centralF.cdf(args[0],args[1],args[2])}anovafscore=jStat.anovafscore(args);df1=args.length-1;n=0;for(i=0;i<args.length;i++){n=n+args[i].length}df2=n-df1-1;return 1-jStat.centralF.cdf(anovafscore,df1,df2)},ftest:function(fscore,df1,df2){return 1-jStat.centralF.cdf(fscore,df1,df2)}});jStat.extend(jStat.fn,{anovafscore:function(){return jStat.anovafscore(this.toArray())},anovaftest:function(){var n=0,i;for(i=0;i<this.length;i++){n=n+this[i].length}return jStat.ftest(this.anovafscore(),this.length-1,n-this.length)}});jStat.extend({normalci:function(){var args=slice.call(arguments),ans=new Array(2),change;if(args.length===4){change=Math.abs(jStat.normal.inv(args[1]/2,0,1)*args[2]/Math.sqrt(args[3]))}else{change=Math.abs(jStat.normal.inv(args[1]/2,0,1)*jStat.stdev(args[2])/Math.sqrt(args[2].length))}ans[0]=args[0]-change;ans[1]=args[0]+change;return ans},tci:function(){var args=slice.call(arguments),ans=new Array(2),change;if(args.length===4){change=Math.abs(jStat.studentt.inv(args[1]/2,args[3]-1)*args[2]/Math.sqrt(args[3]))}else{change=Math.abs(jStat.studentt.inv(args[1]/2,args[2].length)*jStat.stdev(args[2],true)/Math.sqrt(args[2].length))}ans[0]=args[0]-change;ans[1]=args[0]+change;return ans},significant:function(pvalue,alpha){return pvalue<alpha}});jStat.extend(jStat.fn,{normalci:function(value,alpha){return jStat.normalci(value,alpha,this.toArray())},tci:function(value,alpha){return jStat.tci(value,alpha,this.toArray())}})})(this.jStat,Math);